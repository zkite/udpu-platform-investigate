# Notes

## Изменения UI
- В деталях job добавлен запуск через WebSocket, чтобы из фронтенда отправлять команду `run job <name>` и получать ответ из `/api/v1.0/pub`. Для подключения требуется указать `channel` (идентификатор клиента/UDPU), совпадающий с используемым в текущем API. Реализация делает одноразовое подключение и ожидает один ответ, после чего закрывает сокет.

## Ограничения и допущения
- В UI отсутствует механизм обнаружения доступных `channel`; пользователь вводит его вручную, так как это значение хранится вне UI и задаётся внешними процессами.

## Скриншот
- Попытка сделать скриншот через Playwright не удалась: локальный Streamlit не запустился, страница вернула пустой ответ.

## Изменения интерфейса Jobs
- Для выбора канала запуска джобы используется выпадающий список subscriber_uid, который собирается из uDPU по всем локациям; если список недоступен/пуст, остаётся ручной ввод.
- Джоба `registered_device` скрыта из списка и принудительно не отображается в деталях (возврат к списку).
- Ответ выполнения джобы очищается при смене джобы и при выходе из просмотра деталей (а также при уходе с вкладки Jobs).

## Ограничения
- Источник списка каналов зависит от доступности `/udpu/locations` и `/{location}/udpu_list` в API; при ошибке списка используется ручной ввод.

## Исправление ошибки Redis NoneType при создании job
- Исключён вывод полей со значением None при сериализации JobSchema, чтобы Redis hset не получал None (ошибка Invalid input of type: 'NoneType').
- Контракт публичного API не менялся, сериализация влияет только на запись в Redis.
